(function(a){window.MBP=window.MBP||{};MBP.viewportmeta=a.querySelector&&a.querySelector('meta[name="viewport"]');MBP.ua=navigator.userAgent;MBP.scaleFix=function(){if(MBP.viewportmeta&&/iPhone|iPad/.test(MBP.ua)&&!/Opera Mini/.test(MBP.ua)){MBP.viewportmeta.content="width=device-width, minimum-scale=1.0, maximum-scale=1.0";a.addEventListener("gesturestart",MBP.gestureStart,false);}};MBP.gestureStart=function(){MBP.viewportmeta.content="width=device-width, minimum-scale=0.25, maximum-scale=1.6";};MBP.hideUrlBar=function(){/iPhone/.test(MBP.ua)&&!pageYOffset&&!location.hash&&setTimeout(function(){window.scrollTo(0,1);},1000);};MBP.fastButton=function(b,c){this.element=b;this.handler=c;if(b.addEventListener){b.addEventListener("touchstart",this,false);b.addEventListener("click",this,false);}};MBP.fastButton.prototype.handleEvent=function(b){switch(b.type){case"touchstart":this.onTouchStart(b);break;case"touchmove":this.onTouchMove(b);break;case"touchend":this.onClick(b);break;case"click":this.onClick(b);break;}};MBP.fastButton.prototype.onTouchStart=function(b){b.stopPropagation();this.element.addEventListener("touchend",this,false);a.body.addEventListener("touchmove",this,false);this.startX=b.touches[0].clientX;this.startY=b.touches[0].clientY;this.element.style.backgroundColor="rgba(0,0,0,.7)";};MBP.fastButton.prototype.onTouchMove=function(b){if(Math.abs(b.touches[0].clientX-this.startX)>10||Math.abs(b.touches[0].clientY-this.startY)>10){this.reset();}};MBP.fastButton.prototype.onClick=function(b){b.stopPropagation();this.reset();this.handler(b);if(b.type=="touchend"){MBP.preventGhostClick(this.startX,this.startY);}this.element.style.backgroundColor="";};MBP.fastButton.prototype.reset=function(){this.element.removeEventListener("touchend",this,false);a.body.removeEventListener("touchmove",this,false);this.element.style.backgroundColor="";};MBP.preventGhostClick=function(b,c){MBP.coords.push(b,c);window.setTimeout(function(){MBP.coords.splice(0,2);},2500);};MBP.ghostClickHandler=function(e){for(var d=0,c=MBP.coords.length;d<c;d+=2){var b=MBP.coords[d];var f=MBP.coords[d+1];if(Math.abs(e.clientX-b)<25&&Math.abs(e.clientY-f)<25){e.stopPropagation();e.preventDefault();}}};if(a.addEventListener){a.addEventListener("click",MBP.ghostClickHandler,true);}MBP.coords=[];MBP.autogrow=function(d,b){function e(h){var g=this.scrollHeight,i=this.clientHeight;if(g>i){this.style.height=g+3*f+"px";}}var c=(b)?b:12,f=d.currentStyle?d.currentStyle.lineHeight:getComputedStyle(d,null).lineHeight;f=(f.indexOf("px")==-1)?c:parseInt(f,10);d.style.overflow="hidden";d.addEventListener?d.addEventListener("keyup",e,false):d.attachEvent("onkeyup",e);};})(document);