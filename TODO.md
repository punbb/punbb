
## TODO

### Языковые пакеты как расширения

- новый "домен" 'extension1' регистрируется (путь к файлу для загрузки добавляется в ассоциативный массив) через расширение типа "языковой пакет"
или может заменить путь по умолчанию
- переделать в виде сервиса функция возвращает массив по заданному параметру russian english + "регистрация" списке имеюзихся трансляций

rewrites - сервис, url('url_id')

### расширения

- расширения в виде пакетов composer вида punbb-extensionname
- пример composer.json файла 
{
  "name": "punbb/lang-English",
  "description": "PUNBB English language definitions",
  "authors": [
    {
      "name": "Your Name",
      "email": "your@name.com"
    }
  ],
  "autoload": {
    "files": [
        "init.php" <- тут иницализация расширения (настройка сервисов, добавление информации по расширению и т.п.).
    ]
  }
}

- в init.php файле задется настройка расширинения - тема, языковой пакет, рауты. может сожержать свой namespace, переменные. но настройка punbb только через методы класса PUNBB.
- настройка запуска композером команд install.php update.php uninstall.php при composer install, composer update 
- в простейшем случае - если нет настроек БД и т.п. скрипты типа install.php не нужны - просто как стандартный пакет композера
- web-интерфейс для управления расширениями - это будет просто интерфейс для команд композера - нужен ли?- если возможно, предусмотреть установку без композера - т.е. компируется расширение в нужную папку, запускается install.php или update.php через браузер 

### шаблоны

- view, helper - всегда выводит данные вместо записи в буфер - облегчит отладку и улучшит производительность
- возможность переопределить функции (может реализовать на классах с DI)
- переопределяющее расширение заботится об буферизации контента - если оно нужно
- ? событие на вывод страницы page_render

примеры использования - кеширование html-блоков, обработка контента блока

- ? возможность подмены макета через расширения ("layout_apply" ?)

### ORM или функции для работы с сущностями

чтобы можно было модифицировать запрос через расширения

~~forum_add() ...~~
~~forum_get() ...~~
~~topic_add() ...~~
~~user_add() ...~~
...

### события

передача по значению, возвращая значение может работать как фильтр

    event_trigger('page_before_render', $data)

    foreach ($_PUNBB['event'][$event] as $handler) {
        if (is_callable($handler)) {
            $result = call_user_func($handler, $data);
            if ($result !== false) {
                $data = $result;
                ???
            }
        }
    }

    event_add(event, handler) добавляет и возвращает индекс
    event_remove(event, index) - удаляет по индексу

хранениие

    $_PUNBB['event']['page_before_render'] = array(handler1, handler2, handler3)

обработчик

    function handler1($data) {
        return false; - останавливает цикл вызова обработчиков
        return $some_modified_data; - или возвращает какойто результат
        или лучше [$some_modified_data, false]
        если надо возвратить результат и остановить цикл
    }

## Структура темы

Блоки основного контента:

    /login/main.php
    /...

Общие макеты:
    
    /layout/main.php
    /layout/admin.php
    /layout/...

Хелперы:

    /helper/main_menu.php    
    /helper/...

Стандартные шаблоны:

    include/view/layout/...
    include/view/helper/...
    include/view/...

## Переопределение шаблонов

Проверяется подключаемый шаблон в папке текущей темы, например login/main
    
    /login/main.php
    
если такого файла нет, берется стандартный

    include/view/login/main.php
